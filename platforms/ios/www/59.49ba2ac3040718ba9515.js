(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{"f+ep":function(e,n,t){"use strict";t.r(n);var l=t("8Y7J");class o{}var a=t("pMnS"),r=t("oBZk"),i=t("ZZ/e"),s=t("mrSG"),u=t("3rA1"),c=t("SPri"),g=t("NzdG"),d=t("KGI4"),p=t("D5/n"),h=t("BOF4"),m=t.n(h),f=t("Tcs0"),b=t("YCZo"),k=t("9Ap/"),v=t("8riC");class x{constructor(e,n,t,l,o,a,r,i,s,u,c,g,d,p){this.navCtrl=e,this.authService=n,this.platform=t,this.fb=l,this.storage=o,this.fcm=a,this.searchhotel=r,this.appVersion=i,this.valueGlobal=s,this.googlePlus=u,this.alertCtrl=c,this.toastCtrl=g,this.loadingCtrl=d,this.gf=p,this.isLoggedIn=!1,this.storage.get("checkreview").then(e=>{this.checkreview=e}),this.appVersion.getVersionNumber().then(e=>{this.appversion=e}),p.googleAnalytion("login","load","")}ngOnInit(){}ionViewWilEnter(){this.platform.ready().then(()=>{console.log("read token complete")})}ionViewDidLoad(){let e=document.querySelectorAll(".tabbar");null!=e&&Object.keys(e).map(n=>{e[n].style.display="none"})}loginfb(){var e=this;e.presentLoadingnotime();const n=["public_profile","email"];e.fb.login(n).then(t=>{e.fb.api("me?fields=id,name,email,first_name,gender,picture.width(720).height(720).as(picture_large)",n).then(n=>{e.fb.getLoginStatus().then(t=>{e.userData={accessToken:t.authResponse.accessToken,id:n.id,email:n.email,UserName:n.first_name,picture:n.picture_large.data.url,username:n.name,phone:n.phone,gender:n.gender},e.userData.email?e.postDatafb():e.checknomail()})})}).catch(n=>{e.loader.dismiss()}),e.gf.googleAnalytion("login","loginfacebook","")}postDatafb(){var e=this,n={method:"POST",url:d.a.urls.baseUrl.urlMobile+"/api/account/socialLogin",timeout:1e4,maxAttempts:5,retryDelay:2e3,headers:{"cache-control":"no-cache","content-type":"application/json"},body:{userData:{email:this.userData.email,name:this.userData.username,id:this.userData.id,image:this.userData.picture,provider:"facebook",token:"",idToken:this.userData.accessToken}},json:!0};p(n,function(t,l,o){if(t&&(t.page="login",t.func="postDataFb",t.param=JSON.stringify(n),d.a.writeErrorLog(t,l)),200!=l.statusCode){var a={page:"login",func:"postDataFb",message:l.statusMessage,content:l.body,type:"warning",param:JSON.stringify(n)};d.a.writeErrorLog(a,l)}if(o.result){var r,i=m()(o.auth_token);if(e.refreshTokenTimer=i.refreshTokenTimer,e.storage.set("email",i.email),e.storage.set("auth_token",o.auth_token),e.storage.set("username",i.fullname),e.hasWhiteSpace(i.fullname)){var s=i.fullname.split(" ");if(s.length>2){let e="";for(let n=1;n<s.length;n++)e+=1==n?s[n]:" "+s[n];r={ho:s[0],ten:e,phone:i.phone}}else s.length>1?r={ho:s[0],ten:s[1],phone:i.phone}:1==s.length&&(r={ho:s[0],ten:"",phone:i.phone});e.storage.remove("infocus"),e.storage.remove("listblogtripdefault"),e.storage.remove("listblogdefault"),e.storage.remove("listtopdealdefault"),e.storage.remove("regionnamesuggest"),e.valueGlobal.countNotifi=0,e.storage.set("infocus",r),e.gf.setParams(!0,"resetBlogTrips")}else e.storage.set("infocus",r={ho:"",ten:"",phone:i.phone});Array.isArray(i.jti)?e.storage.set("jti",i.jti[0]):e.storage.set("jti",i.jti),e.checkreview||e.storage.set("checkreview",0),e.storage.set("point",i.point),e.fcm.getToken().then(n=>{e.deviceToken=n,e.deviceToken&&e.gf.pushTokenAndMemberID(o.auth_token,e.deviceToken,e.appversion)}),e.searchhotel.rootPage="login",e.countdownRefreshToken(),e.loader&&e.loader.dismiss(),e.valueGlobal.logingoback?e.navCtrl.navigateForward([e.valueGlobal.logingoback]):e.navCtrl.navigateRoot("/")}})}countdownRefreshToken(){var e=parseInt(this.refreshTokenTimer);this.countdownTimer(e)}countdownTimer(e){e>=0&&(clearInterval(this.valueGlobal.interval),this.valueGlobal.interval=setInterval(()=>{--e<0&&(clearInterval(this.valueGlobal.interval),this.reloadToken())},1e3))}reloadToken(){this.refreshToken()}refreshToken(){var e=this;e.storage.get("auth_token").then(n=>{if(n){var t={method:"GET",url:d.a.urls.baseUrl.urlMobile+"/api/Account/reloadTokenClaims",headers:{"cache-control":"no-cache","content-type":"application/json",authorization:"Bearer "+n}};p(t,function(n,l,o){if(200!=l.statusCode){var a={page:"roompaymentdoneean",func:"refreshToken",message:l.statusMessage,content:l.body,type:"warning",param:JSON.stringify(t)};d.a.writeErrorLog(a,l)}if(n)n.page="roompaymentdoneean",n.func="refreshToken",n.param=JSON.stringify(t),d.a.writeErrorLog(n,l);else{var r=JSON.parse(o);r.auth_token&&(e.storage.remove("auth_token"),e.storage.set("auth_token",r.auth_token),e.countdownRefreshToken())}})}})}hasWhiteSpace(e){return e.indexOf(" ")>=0}checknomail(){var e=this,n={method:"POST",url:d.a.urls.baseUrl.urlMobile+"/api/account/CheckSocialNoEmail",timeout:1e4,maxAttempts:5,retryDelay:2e3,headers:{"cache-control":"no-cache","content-type":"application/json"},body:{userData:{id:this.userData.id,idToken:"",image:this.userData.picture,name:this.userData.username,provider:"facebook",token:this.userData.accessToken}},json:!0};p(n,function(t,l,o){if(t&&(t.page="login",t.func="checknomail",t.param=JSON.stringify(n),d.a.writeErrorLog(t,l)),200!=l.statusCode){var a={page:"login",func:"checknomail",message:l.statusMessage,content:l.body,type:"warning",param:JSON.stringify(n)};d.a.writeErrorLog(a,l)}o.result?e.postDatafb():e.presentPrompt()})}validateEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}logingg(){this.userData={btn:["2"]},this.navCtrl.navigateForward("/blank"),this.gf.googleAnalytion("login","logingoogle","")}logout(){this.fb.logout().then(e=>this.isLoggedIn=!1).catch(e=>{console.log("Error logout from Facebook",e),e&&(e.page="login",e.func="logout",d.a.writeErrorLog(e,null))}),this.gf.googleAnalytion("login","logout","")}logintk(){this.navCtrl.navigateForward("loginusername"),this.gf.googleAnalytion("login","logintk","")}bypasslogin(){this.gf.googleAnalytion("login","bypasslogin","")}presentToast(){return s.__awaiter(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:"Email ho\u1eb7c m\u1eadt kh\u1ea9u kh\xf4ng \u0111\xfang.",duration:3e3,position:"top"})).present()})}openPage(e){}goback(){this.navCtrl.back()}presentPrompt(){return s.__awaiter(this,void 0,void 0,function*(){let e=yield this.alertCtrl.create({subHeader:"T\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n kh\xf4ng c\xf3 email ho\u1eb7c kh\xf4ng \u0111\u1ec3 \u1edf ch\u1ebf \u0111\u1ed9 c\xf4ng khai. Vui l\xf2ng cung c\u1ea5p email \u0111\u1ec3 iVIVU c\xf3 th\u1ec3 x\xe1c \u0111\u1ecbnh v\xe0 b\u1ea3o m\u1eadt t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n:",inputs:[{name:"email",placeholder:"Nh\u1eadp email"}],buttons:[{text:"B\u1ecf qua",role:"cancel",handler:e=>{}},{text:"X\xe1c nh\u1eadn",handler:e=>{if(!e.email)return!1;this.userData.email=e.email,1==this.validateEmail(e.email)?this.postDatafb():this.presentToastemail()}}]});yield e.present()})}presentToastemail(){return s.__awaiter(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:"\u0110\u1ecbnh d\u1ea1ng email kh\xf4ng \u0111\xfang",duration:3e3,position:"top"})).present()})}register(){this.navCtrl.navigateForward("register")}pushTokenAndMemberID(e,n,t){if(e){var l={method:"POST",url:d.a.urls.baseUrl.urlMobile+"/mobile/OliviaApis/PushTokenOfUser",timeout:1e4,maxAttempts:5,retryDelay:2e3,headers:{"cache-control":"no-cache","content-type":"application/json-patch+json",authorization:"Bearer "+e},body:{tokenId:n,appVersion:t.replace(/\./g,"")},json:!0};p(l,function(e,n,t){e?(e.page="login",e.func="pushTokenAndMemberID",e.param=JSON.stringify(l),d.a.writeErrorLog(e,n)):t&&JSON.parse(t)})}}presentLoadingnotime(){return s.__awaiter(this,void 0,void 0,function*(){this.loader=yield this.loadingCtrl.create({message:""}),this.loader.present()})}logintksms(){this.navCtrl.navigateForward("loginsms")}}var C=t("xgBC"),y=l["\u0275crt"]({encapsulation:0,styles:[[".center[_ngcontent-%COMP%]{padding:57px 0 0;text-align:center;height:100%;background-image:url(backgroundnew.6a4f60938350633e5b43.png);background-size:cover}.div-go-back[_ngcontent-%COMP%]{position:absolute;top:16px;color:#fff;width:48px;height:48px}.button-ios[_ngcontent-%COMP%], .button-md[_ngcontent-%COMP%]{text-transform:none!important;font-weight:400!important;height:48px}.hr-register[_ngcontent-%COMP%]{margin-top:31px;z-index:1;background-color:#fff;opacity:.3}.text-line-inlinetext[_ngcontent-%COMP%]{position:absolute;color:#fff;text-align:center;width:100%;margin:22px auto 0;z-index:2;background-color:255,255,255,.3;font-size:14px!important}.row-line[_ngcontent-%COMP%]{position:fixed;width:100%;bottom:90px}.row-register[_ngcontent-%COMP%]{position:fixed;bottom:0;text-align:center;width:100%;padding:35px 0}.text-button[_ngcontent-%COMP%]{text-align:center;width:90%;font-size:16px!important;color:#fff}.button-fb[_ngcontent-%COMP%]{background:#3b5998;text-transform:none!important}.button-gg[_ngcontent-%COMP%]{background:#db4639;text-transform:none!important}.button-outline[_ngcontent-%COMP%]{--border-color:#ffffff;--border-width:1px;--border-style:solid;text-transform:none!important}.my-custom-alert[_ngcontent-%COMP%]   .alert-wrapper[_ngcontent-%COMP%]{min-width:380px!important}@media (min-height:812px) and (max-height:1024px){.row-line[_ngcontent-%COMP%]{position:fixed;width:100%;bottom:165px}.row-register[_ngcontent-%COMP%]{position:fixed;bottom:75px;text-align:center;width:100%;padding:35px 0}}.img-close[_ngcontent-%COMP%]{margin-top:env(safe-area-inset-top);height:40px;margin-left:8px}.m-top-logo[_ngcontent-%COMP%]{margin-top:calc(env(safe-area-inset-top) - 30px)}"]],data:{}});function w(e){return l["\u0275vid"](0,[l["\u0275qud"](402653184,1,{routerOutlet:0}),(e()(),l["\u0275eld"](1,0,null,null,34,"ion-content",[["class","background center"]],null,null,null,r.eb,r.j)),l["\u0275did"](2,49152,null,0,i.IonContent,[l.ChangeDetectorRef,l.ElementRef],null,null),(e()(),l["\u0275eld"](3,0,null,0,32,"div",[["class","center"],["padding","true"]],null,null,null,null,null)),(e()(),l["\u0275eld"](4,0,null,null,2,"ion-card-title",[["class","m-top-logo"]],null,null,null,r.Z,r.f)),l["\u0275did"](5,49152,null,0,i.IonCardTitle,[l.ChangeDetectorRef,l.ElementRef],null,null),(e()(),l["\u0275eld"](6,0,null,0,0,"img",[["src","./assets/logo/logo.svg"],["style","height: 90px;"]],null,null,null,null,null)),(e()(),l["\u0275eld"](7,0,null,null,1,"div",[["class","div-go-back"]],null,[[null,"click"]],function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.goback()&&l),l},null,null)),(e()(),l["\u0275eld"](8,0,null,null,0,"img",[["class","img-close"],["src","./assets/imgs/ios-arrow-round-back-white.svg"]],null,null,null,null,null)),(e()(),l["\u0275eld"](9,0,null,null,8,"div",[["style","margin-top: 110px"]],null,null,null,null,null)),(e()(),l["\u0275eld"](10,0,null,null,1,"button",[["class","button text-button button-fb"],["ion-button",""],["round",""],["style","margin: 0px"]],null,[[null,"click"]],function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.loginfb()&&l),l},null,null)),(e()(),l["\u0275ted"](-1,null,[" \u0110\u0103ng nh\u1eadp b\u1eb1ng Facebook "])),(e()(),l["\u0275eld"](12,0,null,null,2,"div",[["style","text-align:center;margin-top: 10px"]],null,null,null,null,null)),(e()(),l["\u0275eld"](13,0,null,null,1,"button",[["class","button text-button"],["fill","outline"],["shape","round"],["style","text-transform: none;margin: 0px;background-color: #a0c245"]],null,[[null,"click"]],function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.logintksms()&&l),l},null,null)),(e()(),l["\u0275ted"](-1,null,["\u0110\u0103ng nh\u1eadp b\u1eb1ng SMS"])),(e()(),l["\u0275eld"](15,0,null,null,2,"div",[["style","text-align:center;margin-top: 10px"]],null,null,null,null,null)),(e()(),l["\u0275eld"](16,0,null,null,1,"button",[["class","button text-button"],["fill","outline"],["shape","round"],["style","text-transform: none !important;margin: 0px;margin: 0px;border: solid 1px #fff;background-color: transparent;"]],null,[[null,"click"]],function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.logintk()&&l),l},null,null)),(e()(),l["\u0275ted"](-1,null,["\u0110\u0103ng nh\u1eadp b\u1eb1ng t\xe0i kho\u1ea3n iVIVU"])),(e()(),l["\u0275eld"](18,0,null,null,13,"div",[["class","row-line"]],null,null,null,null,null)),(e()(),l["\u0275eld"](19,0,null,null,12,"ion-row",[],null,null,null,r.Ab,r.F)),l["\u0275did"](20,49152,null,0,i.IonRow,[l.ChangeDetectorRef,l.ElementRef],null,null),(e()(),l["\u0275eld"](21,0,null,0,2,"ion-col",[["class","no-padding-left text-line"],["size","3"]],null,null,null,r.db,r.i)),l["\u0275did"](22,49152,null,0,i.IonCol,[l.ChangeDetectorRef,l.ElementRef],{size:[0,"size"]},null),(e()(),l["\u0275eld"](23,0,null,0,0,"hr",[["class","hr-register"]],null,null,null,null,null)),(e()(),l["\u0275eld"](24,0,null,0,4,"ion-col",[["size","6"],["style","text-align: center;padding-left: 0px"]],null,null,null,r.db,r.i)),l["\u0275did"](25,49152,null,0,i.IonCol,[l.ChangeDetectorRef,l.ElementRef],{size:[0,"size"]},null),(e()(),l["\u0275eld"](26,0,null,0,2,"div",[["class","text-line-inlinetext"]],null,null,null,null,null)),(e()(),l["\u0275eld"](27,0,null,null,1,"label",[["style","font-size: 16px"]],null,null,null,null,null)),(e()(),l["\u0275ted"](-1,null,["Ch\u01b0a c\xf3 t\xe0i kho\u1ea3n?"])),(e()(),l["\u0275eld"](29,0,null,0,2,"ion-col",[["class","no-padding-right  text-line"],["size","3"]],null,null,null,r.db,r.i)),l["\u0275did"](30,49152,null,0,i.IonCol,[l.ChangeDetectorRef,l.ElementRef],{size:[0,"size"]},null),(e()(),l["\u0275eld"](31,0,null,0,0,"hr",[["class","hr-register"]],null,null,null,null,null)),(e()(),l["\u0275eld"](32,0,null,null,3,"div",[["class","row-register"]],null,null,null,null,null)),(e()(),l["\u0275eld"](33,0,null,null,2,"div",[["style","text-align:center;margin-top: 10px"]],null,null,null,null,null)),(e()(),l["\u0275eld"](34,0,null,null,1,"button",[["class","button text-button"],["shape","round"],["style","text-transform: none !important;font-weight: 400;margin: 0px;border: solid 1px #fff;background-color: transparent;"]],null,[[null,"click"]],function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.register()&&l),l},null,null)),(e()(),l["\u0275ted"](-1,null,["\u0110\u0103ng k\xfd t\xe0i kho\u1ea3n"]))],function(e,n){e(n,22,0,"3"),e(n,25,0,"6"),e(n,30,0,"3")},null)}function _(e){return l["\u0275vid"](0,[(e()(),l["\u0275eld"](0,0,null,null,1,"app-login",[],null,null,null,w,y)),l["\u0275did"](1,114688,null,0,x,[i.NavController,u.a,i.Platform,c.a,C.b,b.a,k.e,v.a,k.f,g.a,i.AlertController,i.ToastController,i.LoadingController,f.b],null,null)],function(e,n){e(n,1,0)},null)}var T=l["\u0275ccf"]("app-login",x,_,{},{},[]),D=t("SVse"),M=t("s7LF"),O=t("iInd");t.d(n,"LoginPageModuleNgFactory",function(){return P});var P=l["\u0275cmf"](o,[],function(e){return l["\u0275mod"]([l["\u0275mpd"](512,l.ComponentFactoryResolver,l["\u0275CodegenComponentFactoryResolver"],[[8,[a.a,T]],[3,l.ComponentFactoryResolver],l.NgModuleRef]),l["\u0275mpd"](4608,D.NgLocalization,D.NgLocaleLocalization,[l.LOCALE_ID,[2,D["\u0275angular_packages_common_common_a"]]]),l["\u0275mpd"](4608,M["\u0275angular_packages_forms_forms_j"],M["\u0275angular_packages_forms_forms_j"],[]),l["\u0275mpd"](4608,i.AngularDelegate,i.AngularDelegate,[l.NgZone,l.ApplicationRef]),l["\u0275mpd"](4608,i.ModalController,i.ModalController,[i.AngularDelegate,l.ComponentFactoryResolver,l.Injector,D.DOCUMENT]),l["\u0275mpd"](4608,i.PopoverController,i.PopoverController,[i.AngularDelegate,l.ComponentFactoryResolver,l.Injector,D.DOCUMENT]),l["\u0275mpd"](1073742336,D.CommonModule,D.CommonModule,[]),l["\u0275mpd"](1073742336,M["\u0275angular_packages_forms_forms_bc"],M["\u0275angular_packages_forms_forms_bc"],[]),l["\u0275mpd"](1073742336,M.FormsModule,M.FormsModule,[]),l["\u0275mpd"](1073742336,i.IonicModule,i.IonicModule,[]),l["\u0275mpd"](1073742336,O.p,O.p,[[2,O.v],[2,O.n]]),l["\u0275mpd"](1073742336,o,o,[]),l["\u0275mpd"](1024,O.l,function(){return[[{path:"",component:x}]]},[])])})}}]);